---
interface Props {
  title: string;
  subtitle: string;
  body: string;
  href: string;
  image: string;
  readingStatus: string;
  recommended: boolean;
  insight?: string;
  intentTags?: string[];
  slug: string;
}

let tagBasedCSS = "";

const {
  href,
  title,
  subtitle,
  body,
  image,
  readingStatus,
  recommended,
  insight,
  intentTags,
  slug,
} = Astro.props;

let displayStatus = readingStatus;

switch (readingStatus) {
  case "Read ‚úÖ":
    tagBasedCSS = "greenTag";
    displayStatus = "Read";
    break;
  case "Currently Reading üëì":
    tagBasedCSS = "blueTag";
    displayStatus = "Currently Reading";
    break;
  case "Next Up ‚è≠Ô∏è":
    tagBasedCSS = "blueTag";
    displayStatus = "Next Up";
    break;
  case "Wishlisted ‚≠ê":
    tagBasedCSS = "orangeTag";
    displayStatus = "Wishlisted";
    break;
  default:
    break;
}
---

<li class="link-card">
  <div class="status-container">
    {
      recommended ? (
        <div class="tag yellowTag font-mono">Recommended</div>
      ) : (
        <div class={"tag " + tagBasedCSS + " font-mono"}>{displayStatus}</div>
      )
    }
  </div>
  <div class="bookDetails">
    <img src={image} alt={title + " Cover"} />
    <h3>{title}<br /><span>{subtitle}</span></h3>
    <!-- <p class="bookDescription">{body}</p> -->
    <div class="my-auto flex flex-col gap-0 mt-3">
      {
        insight && (
          <p class="insight text-xs mb-0">
            <i class="not-italic bi bi-coin text-xs mr-1" /> {insight}
          </p>
        )
      }
      {
        intentTags && intentTags.length > 0 && (
          <div class="intent-tags">
            <i class="bi bi-tags text-xs" />
            {intentTags.map((tag) => (
              <div class="tag intentTag">{tag}</div>
            ))}
          </div>
        )
      }
    </div>
  </div>
  <div class="bookButtons">
    <!-- <a class="secondary" href={"/books-for-devs/books/" + slug}>Learn More</a> -->
    <a href={href}>Buy Now on <i class="bi bi-amazon"></i></a>
  </div>
</li>
<style>
  @reference "../styles/global.css";
  .link-card {
    background-color: var(--bg);
    background-position: 100%;
    background-size: 100%;
    @apply rounded-[0.6rem] flex flex-col list-none p-4 transition-[background-position] duration-600 ease-[cubic-bezier(0.22,1,0.36,1)] shadow-[0_4px_12px_-1px_#0000001a,0_4px_24px_-2px_#0000001a] relative;
  }

  h3 {
    @apply text-xl leading-[1.1] m-0 transition-colors duration-600 ease-[cubic-bezier(0.22,1,0.36,1)] text-balance max-w-[calc(100vw-120px)];
  }
  h3 > span {
    @apply text-xs font-light leading-[0.6rem];
  }
  h3:hover {
    @apply ml-1 transition-all duration-150 ease-[cubic-bezier(0.22,1,0.36,1)];
  }
  .bookDetails {
    @apply relative -top-[10%];
  }
  .bookDetails img {
    @apply rounded-[0.4rem] max-h-[160px] max-w-[110px] mb-2 shadow-(--boxShadow);
  }

  .insight {
    @apply text-xs mt-3 mb-1 italic leading-relaxed max-w-[90%];
  }

  .intent-tags {
    @apply flex flex-wrap gap-1 max-w-[90%];
  }

  .bookButtons {
    @apply flex justify-between mt-auto gap-4 mb-0 sm:text-sm;
  }

  .bookButtons > a {
    @apply bg-(--buttonBg) rounded-[0.35rem] text-(--buttonText) flex justify-between gap-2 leading-none opacity-80 py-3 px-4 no-underline sm:p-2 sm:justify-start;
  }

  .bookButtons > a:hover {
    @apply bg-(--buttonBgHover);
  }

  .bookButtons > a.secondary {
    @apply bg-transparent border-2 border-(--buttonBg) text-(--buttonAltText);
  }

  .bookButtons > a.secondary:hover {
    @apply border-(--buttonBgHover) text-(--buttonBgHover);
  }

  .link-card:is(:hover, :focus-within) {
    background-image: var(--book-card-gradient);
  }
  .link-card:is(:hover, :focus-within) h2 {
    color: var(--text);
  }
  .status-container {
    @apply absolute right-4 top-4 flex flex-col items-end gap-2 z-10;
  }
  /* Updated tag styles to be relative to container, removing absolute positioning */
  .tag {
    @apply bg-(--bg) rounded-xl border border-(--buttonText) text-(--buttonText) text-xs py-1 px-2.5 w-max sm:text-balance sm:inline sm:text-[0.5rem] sm:py-1 sm:px-2 sm:max-w-full;
  }
  .intentTag {
    @apply bg-transparent border-0 text-(--lightGrey) scale-90;
  }
  .primaryTag {
    @apply border-(--primary) text-(--primary);
  }
  .blueTag {
    @apply border-(--blue) text-(--blue);
  }
  .greenTag {
    @apply border-(--green) text-(--green);
  }
  .yellowTag {
    @apply border-(--yellow) text-(--text);
  }
  .orangeTag {
    @apply border-[#e9892d] text-[#e9892d];
  }
</style>
